<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="description" content="Pol's website. Notes on Using AVRDUDE"/>

<link rel="icon" type="image/png" sizes="192x192" href="/res/img/favicon192.png">
<link rel="icon" type="image/png" sizes="128x128" href="/res/img/favicon128.png">
<link rel="icon" type="image/png" sizes="64x64" href="/res/img/favicon64.png">
<link rel="shortcut-icon" type="image/png" href="/res/img/favicon64.png">

<link rel="stylesheet" href="/res/css/style.css">
<link rel="styleshet" href="/res/css/foundation-icons.css">

<title>Paolo Scaramuzza | Notes on Using AVRDUDE</title>
</head>
<body>
<div class="header">
	<div class="headerdata">
		<h1><a class="homelink" href="/">Paolo Scaramuzza</a></h1>
	</div>
	<div class="navbar">
		<a href="/">HOME</a> |
		<a href="/article-index.html">ARTICLES</a> |
		<a href="/random.html">RANDOM STUFF</a> |
		<a href="/now.html">NOW</a> |
		<a href="/about.html">ABOUT</a>
	</div>
</div>

<div id="content" class="content">
	<div id="text" class="tile text">
	<!-- Article text -->
<h1>Notes on Using AVRDUDE</h1><h2>Introduction</h2><p><a href="http://www.nongnu.org/avrdude/">avrdude</a> is the standard command-line utility to program Atmel/Microchip AVR microcontrollers.  It supports multiple programmers, including: </p><ul><li><strong>serialUPDI</strong> (for new ATtiny/mega0/1-series with UPDI interface)</li><li><strong>AVRISP mkII</strong> (ISP/PDI/TPI programmer, see Appendix A for legacy setup)</li></ul><p>This article collects practical usage notes, examples, and troubleshooting tips when working with <tt> avrdude</tt>  on GNU/Linux. </p><h2>Example Session with SerialUPDI (ATtiny816)</h2><pre><code>     Using Port                    : /dev/ttyUSB0                            
     Using Programmer              : serialupdi                              
     Overriding Baud Rate          : 230400                                  
     AVR Part                      : ATtiny816                               
     RESET disposition             : dedicated                               
     RETRY pulse                   : SCK                                     
     Serial program mode           : yes                                     
     Parallel program mode         : yes  
 
                                      Block Poll               Page                       Polled                                                            
       Memory Type Alias    Mode Delay Size  Indx Paged  Size   Size #Pages MinW  MaxW   ReadBack                                                            
       ----------- -------- ---- ----- ----- ---- ------ ------ ---- ------ ----- ----- ---------  
       fuse0       wdtcfg      0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuse1       bodcfg      0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuse2       osccfg      0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuse4       tcd0cfg     0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuse5       syscfg0     0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuse6       syscfg1     0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuse7       append      0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuse8       bootend     0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       fuses                   0     0     0    0 no          9   10      0     0     0 0x00 0x00                                                            
       lock                    0     0     0    0 no          1    1      0     0     0 0x00 0x00                                                            
       tempsense               0     0     0    0 no          2    1      0     0     0 0x00 0x00                                                            
       signature               0     0     0    0 no          3    1      0     0     0 0x00 0x00                                                            
       prodsig                 0     0     0    0 no         61   61      0     0     0 0x00 0x00                                                            
       sernum                  0     0     0    0 no         10    1      0     0     0 0x00 0x00                                                            
       osccal16                0     0     0    0 no          2    1      0     0     0 0x00 0x00                                                            
       osccal20                0     0     0    0 no          2    1      0     0     0 0x00 0x00                                                            
       osc16err                0     0     0    0 no          2    1      0     0     0 0x00 0x00                                                            
       osc20err                0     0     0    0 no          2    1      0     0     0 0x00 0x00                                                            
       data                    0     0     0    0 no          0    1      0     0     0 0x00 0x00                                                            
       userrow     usersig     0     0     0    0 no         32   32      0     0     0 0x00 0x00                                                            
       eeprom                  0     0     0    0 no        128   32      0     0     0 0x00 0x00                                                            
       flash                   0     0     0    0 no       8192   64      0     0     0 0x00 0x00 </code></pre><p>Detected memory areas: </p><ul><li>Fuses (fuse0 … fuse8, syscfg, osccfg, etc.)</li><li>Lock bits</li><li>Signature / production signature / serial number</li><li>User row (usersig)</li><li>EEPROM (128 bytes)</li><li>Flash (8 KB)</li></ul><h2>Common avrdude Options</h2><pre><code>-p &lt;partno&gt;      Specify AVR device; `-p ?` lists all supported devices  
-c &lt;programmer&gt;  Specify programmer; `-c ?` lists all supported programmers  
-P &lt;port&gt;        Connection (e.g. /dev/ttyUSB0, usb)  
-b &lt;baudrate&gt;    Override serial baudrate  
-U &lt;mem&gt;:op:file[:fmt]  Perform memory operation  
-e               Erase chip before programming  
-t               Start interactive terminal  
-v               Verbose (repeat for more detail)  
-q               Quell progress output  
-T &lt;terminal cmd line&gt; Run terminal line when it is its turn </code></pre><h3>Memory Operations (-U)</h3><ul><li><tt>flash:r|w|v:<file> </tt>  - read/write/verify flash</li><li><tt>eeprom:r|w|v:<file> </tt>  - read/write/verify EEPROM</li><li><tt>fuses:r|w:<file> </tt>  - access fuse bytes</li><li><tt>userrow:r|w:<file> </tt>  - read/write the USERROW</li></ul><h3>File formats (:fmt)</h3><ul><li><tt>:a</tt>  - auto-detect</li><li><tt>:b</tt>  - 0b-binary byte list</li><li><tt>:d</tt>  - decimal byte list</li><li><tt>:e</tt>  - ELF</li><li><tt>:h</tt>  - 0x-hexadecimal byte list</li><li><tt>:i</tt>  - Intel Hex</li><li><tt>:I</tt>  - Intel Hex with comments</li><li><tt>:m</tt>  - in-place immediate</li><li><tt>:o</tt>  - octal byte list</li><li><tt>:r</tt>  - raw binary</li><li><tt>:R</tt>  - R byte list</li><li><tt>:s</tt>  - Motorola S-Record</li></ul><h2>Practical Examples</h2><h3>Read EEPROM</h3><pre><code>avrdude -v -p t816 -c serialupdi -P /dev/ttyUSB0 -U eeprom:r:-:h </code></pre><h3>Read USERROW</h3><pre><code>avrdude -v -p t816 -c serialupdi -P /dev/ttyUSB0 -U userrow:r:-:h </code></pre><p>Saay you want to read the data stored in the userrow directly, the C code is the following: </p><pre><code>/**  
 * Start address for the USERROW segment containing configuration data  
 */  
#define USERROW_CONFIG_BASE 0x1300  
 
// The USERROW is memory mapped  
typedef struct {  
	uint8_t var1;  
	[...]  
	uint8_t varN;  
} userrow_struct_t;  
#define userrow (*(volatile const userrow_struct_t *)USERROW_CONFIG_BASE) </code></pre><h3>Dump USERROW/EEPROM</h3><pre><code>avrdude -v -pt816 -cserialupdi -P /dev/ttyUSB0 -T 'dump eeprom' </code></pre><p>For the userrow: <code>dump userrow</code>. </p><h3>Interacrive shell</h3><pre><code>avrdude -v -pt816 -cserialupdi -P /dev/ttyUSB0 -t  
 
dump userrow  
 
write userrow 0 0xBABBE0  
0000  e0 bb ba 00 ff ff ff ff  ff ff ff ff ff ff ff ff  |................|  
0010  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|  
 
write userrow 0 0xBA, 0xBB, 0xE0, 0x00  
0000  ba bb e0 00 ff ff ff ff  ff ff ff ff ff ff ff ff  |................|  
0010  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|  
 
flush   : synchronise flash and EEPROM cache with the device  
 
dump eeprom  
dump flash  
dump fuses  
 
erase flash; erase eeprom; flush </code></pre><p>The shell session can also be condensed as a single <tt> -T</tt>  command invocation: </p><pre><code>avrdude -v -pt816 -cserialupdi -P /dev/ttyUSB0 -T 'write userrow 0 0x1 0 255 16; flush' </code></pre><h2>Appendix A – AVRISP mkII Setup Guide (Legacy)</h2><p>The following section is preserved from an older tutorial. It describes how to build avrdude with support for the AVRISP mkII on GNU/Linux. It remains useful for reference if you are using older ATmega/ATtiny devices with ISP or PDI interfaces. </p><h3>Introduction</h3><p>The <a href="http://www.atmel.com/tools/AVRISPMKII.aspx">AVRISP mk2</a> is an USB programmer for Atmel 8-bit microcontrollers with ISP (ATtiny, ATmega), PDI (ATxmega) or TPI (smaller ATtiny) interface. </p><p>It can be used either with: </p><ul><li><a href="http://www.atmel.com/tools/ATMELSTUDIO.aspx">Atmel Studio</a> (Windows only)</li><li><a href="http://playground.arduino.cc/">Arduino Playground</a> (Windows, MAC, Linux)</li><li><a href="http://www.nongnu.org/avrdude/">avrdude</a> (virtually any OS, directly from the command line).</li></ul><p>Please note that the Arduino Playground uses avrdude under the hood to burn the firmware onto microcontrollers if the arduino bootloader is not used. </p><p>This guide is about building, installing and using avrdude on GNU/Linux.  Due to <a href="https://savannah.nongnu.org/bugs/index.php?40831">a bug</a> in the most recent version of avrdude in order for the AVRISP mk2 to be recognized and used the program must be manually built after applying a patch to the source code. </p><h3>Installing Required Packages</h3><p>First of all we are going to install some helper programs and libraries. This process varies depending on your distribution of choice. </p><p>The packages listed below are the bare minimum required to build avrdude from source. You may also like to install <code>gcc-avr binutils-avr avr-libc</code> in order to compile the firmware for Atmel microcontrollers. </p><h4>Debian/Ubuntu/Linux Mint</h4><p>As root run: </p><pre><code># apt-get install wget bison automake autoconf flex gcc libelf-dev  
libusb-dev libusb-1.0-0-dev libftdi-dev libftdi1-dev` </code></pre><h4>Red Hat/Centos/Fedora</h4><p>As root run: </p><pre><code># yum install wget bison automake autoconf flex gcc patch  
elfutils-libelf-devel libusb-devel libftdi-devel` </code></pre><h3>Compiling and Installing avrdude</h3><p>First of all we need to prepare a working directory to store the source code, place it where you like: </p><pre><code>$ mkdir avrdude; cd avrdude </code></pre><p>Get the source code for the latest version (at the time of writing it is version 6.2): </p><pre><code>$ wget -qO- http://download.savannah.gnu.org/releases/avrdude/avrdude-6.2.tar.gz | tar zxv --strip-components 1 </code></pre><p>Download and apply the patch to fix the bug (the patch is for version 6.2): </p><pre><code>$ wget -qO- https://savannah.nongnu.org/support/download.php?file_id=32171 | patch </code></pre><p>We are now ready to build! </p><pre><code>$ ./bootstrap &amp;&amp; ./configure &amp;&amp; make -j2 </code></pre><p>If no error is received avrdude is ready to rock with the AVRISP mk2. Before installing you can try if everything works by running the command <code>$ ./avrdude -v</code> which should display the current version and the build date. </p><p>You can now run avrdude directly from the build directory or better still install it system-wide. To do so you need root privileges. Run the following commands as root: </p><pre><code># make install &amp;&amp; cp ./avrdude /usr/bin/ </code></pre><p>Now you are done. In the following section some useful avrdude commands are listed. Try them to see if everything was configured correctly. </p><h3>Testing Communication</h3><p>Connect the programmer to a microcontroller. Assuming you are using an ATmega16 the command you should runt to test the connection is: </p><pre><code>$ avrdude -p m16 -c avrispmkII -P usb </code></pre><p>If something goes wrong ensure that <a href="http://www.droids-corp.org/blog/html/2013/05/14/olimex_avr_isp_mk2.html">udev was configured correctly</a> and the electrical connections are OK. </p><p>To see the list of devices supported by avrdude issue: <code>avrdude -p ?</code> </p><p>A sample programming line for avrdude would be: </p><pre><code>avrdude -p m328p -P usb -c avrispmkII -e -U flash:w:test.hex:i </code></pre><p>If none of the above commands report any error you are ready to go. Happy programming. </p>
	</div> <!-- text -->
</div> <!-- content -->
</body>
</html>
<!-- Build timestamp: 2025-12-05T09:46:26.368539+01:00 -->